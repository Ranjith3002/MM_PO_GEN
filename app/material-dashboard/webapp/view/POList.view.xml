<mvc:View
    controllerName="ai.mm.materialdashboard.controller.POList"
    xmlns:mvc="sap.ui.core.mvc"
    displayBlock="true"
    xmlns="sap.m"
    xmlns:core="sap.ui.core">
    
    <Page id="poListPage" title="{i18n>poListViewTitle}" showNavButton="true" navButtonPress="onNavBack">
        <content>
            <VBox class="sapUiMediumMargin">
                <!-- Header with filters and refresh -->
                <HBox justifyContent="SpaceBetween" alignItems="Center" class="sapUiMediumMarginBottom">
                    <Title text="{i18n>poListViewTitle}" level="H2" />
                    <HBox>
                        <ComboBox 
                            id="filterComboBox"
                            placeholder="Filter by type"
                            selectionChange="onFilterChange"
                            width="200px"
                            class="sapUiMediumMarginEnd">
                            <core:Item key="all" text="{i18n>filterAll}" />
                            <core:Item key="ai" text="{i18n>filterAISuggested}" />
                            <core:Item key="manual" text="{i18n>filterManual}" />
                        </ComboBox>
                        <Button 
                            text="{i18n>refreshBtn}" 
                            icon="sap-icon://refresh" 
                            press="onRefresh" />
                    </HBox>
                </HBox>

                <!-- Purchase Orders Table -->
                <Table 
                    id="poTable"
                    items="{
                        path: '/PurchaseOrders',
                        parameters: {
                            $expand: 'material'
                        }
                    }"
                    growing="true"
                    growingThreshold="20"
                    mode="None"
                    class="sapUiResponsiveMargin">
                    
                    <headerToolbar>
                        <Toolbar>
                            <Title text="{i18n>poListTitle}" />
                            <ToolbarSpacer />
                            <Text text="{
                                parts: ['/PurchaseOrders'],
                                formatter: '.formatItemsCount'
                            }" />
                        </Toolbar>
                    </headerToolbar>

                    <columns>
                        <Column>
                            <Text text="{i18n>materialNamePO}" />
                        </Column>
                        <Column>
                            <Text text="{i18n>quantity}" />
                        </Column>
                        <Column>
                            <Text text="{i18n>suggestedByAI}" />
                        </Column>
                        <Column>
                            <Text text="{i18n>orderDate}" />
                        </Column>
                        <Column>
                            <Text text="{i18n>deliveryDate}" />
                        </Column>
                    </columns>

                    <items>
                        <ColumnListItem>
                            <cells>
                                <Text text="{material/name}" />
                                <ObjectNumber 
                                    number="{quantity}" 
                                    unit="pcs" />
                                <ObjectStatus 
                                    text="{
                                        path: 'suggestedByAI',
                                        formatter: '.formatAISuggested'
                                    }"
                                    state="{
                                        path: 'suggestedByAI',
                                        formatter: '.formatAIState'
                                    }"
                                    icon="{
                                        path: 'suggestedByAI',
                                        formatter: '.formatAIIcon'
                                    }" />
                                <Text text="{
                                    path: 'orderDate',
                                    type: 'sap.ui.model.odata.type.Date'
                                }" />
                                <Text text="{
                                    path: 'deliveryDate',
                                    type: 'sap.ui.model.odata.type.Date'
                                }" />
                            </cells>
                        </ColumnListItem>
                    </items>
                </Table>
            </VBox>
        </content>
    </Page>
</mvc:View>
